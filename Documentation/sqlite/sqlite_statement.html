<HTML><HEAD>
<meta name="description" content="An SQLite statement associated with a database connection.  Note: If a database connection is closed the statement can no longer be used. In some cases,       when a connection is reopened the statement will recompile itself for use with the new       connection. However, this is not guarenteed to work. As such, please use caution when       caching statements when database connections are open and closed."/>
<meta name="legal" content="See notice at end of class."/>
<meta name="keywords" content="Eiffel class"/>
<meta name="copyright" content="Copyright (c) 1984-2013, Eiffel Software"/>
<meta name="license" content="GPL version 2 (see http://www.eiffel.com/licensing/gpl.txt)"/>
<meta name="licensing_options" content="http://www.eiffel.com/licensing"/>
<meta name="copying" content="This file is part of Eiffel Software's Eiffel Development Environment.  Eiffel Software's Eiffel Development Environment is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, version 2 of the License (available at the URL listed under license above).  Eiffel Software's Eiffel Development Environment is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with Eiffel Software's Eiffel Development Environment; if not, write to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA"/>
<meta name="source" content="Eiffel Software 5949 Hollister Ave., Goleta, CA 93117 USA Telephone 805-685-1006, Fax 805-685-6869 Website http://www.eiffel.com Customer support http://support.eiffel.com"/>
<meta name="keywords" content="Eiffel class"/>
<TITLE>sqlite_statement Text</TITLE></HEAD>
<BODY BGCOLOR="white">
<P ALIGN="CENTER">Automatic generation produced by ISE Eiffel</P>
<PRE><TABLE BORDER="1" ALIGN="CENTER"><TR><TD><A HREF="../class_list.html">Classes</A></TD><TD><A HREF="../cluster_list.html">Clusters</A></TD><TD><A HREF="../cluster_hierarchy.html">Cluster hierarchy</A></TD><TD><A HREF="sqlite_statement_chart.html">Chart</A></TD><TD><A HREF="sqlite_statement_links.html">Relations</A></TD><TD>Text</TD><TD><A HREF="sqlite_statement_flat.html">Flat</A></TD><TD><A HREF="sqlite_statement_short.html">Contracts</A></TD><TD><A HREF="sqlite_statement_flatshort.html">Flat contracts</A></TD></TR></TABLE><B>note</B>
    description: "[
        An SQLite statement associated with a database connection.
        
        Note: If a database connection is closed the statement can no longer be used. In some cases,
              when a connection is reopened the statement will recompile itself for use with the new
              connection. However, this is not guarenteed to work. As such, please use caution when
              caching statements when database connections are open and closed.
    ]"
    legal: "See notice at end of class."
    status: "See notice at end of class."
    date: "$Date: 2013-11-07 12:09:47 -0800 (Thu, 07 Nov 2013) $"
    revision: "$Revision: 93250 $"

<B>class</B> 
    <A HREF="../sqlite/sqlite_statement.html">SQLITE_STATEMENT</A>

<B>inherit</B>
    <A HREF="../elks/disposable.html">DISPOSABLE</A>

    <A HREF="../sqlite/sqlite_binding_helpers.html">SQLITE_BINDING_HELPERS</A>

    <A HREF="../sqlite/sqlite_shared_api.html">SQLITE_SHARED_API</A>

    <A HREF="../sqlite/sqlite_internals.html">SQLITE_INTERNALS</A>
        <B>export</B>
            {NONE} <B>all</B>
        <B>end</B>

    <A HREF="../sqlite/sqlite_database_externals.html">SQLITE_DATABASE_EXTERNALS</A>
        <B>export</B>
            {NONE} <B>all</B>
        <B>end</B>

    <A HREF="../sqlite/sqlite_statement_externals.html">SQLITE_STATEMENT_EXTERNALS</A>
        <B>export</B>
            {NONE} <B>all</B>
        <B>end</B>

    <A HREF="../sqlite/sqlite_bind_arg_marshaller.html">SQLITE_BIND_ARG_MARSHALLER</A>
        <B>export</B>
            {NONE} <B>all</B>
        <B>end</B>

<B>create</B> 
    <A HREF="../sqlite/sqlite_statement.html#f_make">make</A>

<B>feature</B> {NONE} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Initialization</FONT>

    <A NAME="f_make"><A HREF="../sqlite/sqlite_statement.html#f_make">make</A> (a_statement: <A HREF="../elks/readable_string_8.html">READABLE_STRING_8</A>; a_db: <A HREF="../sqlite/sqlite_database.html">SQLITE_DATABASE</A>)
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Initializes a SQL statement for a database.</FONT>
            <FONT COLOR="red">--</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> </FONT>`a_statement'<FONT COLOR="red">: SQL statement to compile.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> </FONT>`a_db'<FONT COLOR="red">: A database to compile the statement with.</FONT>
        <B>require</B>
            is_sqlite_available: <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A>
            a_statement_attached: <B>attached</B> a_statement
            not_a_statement_is_empty: <B>not</B> a_statement.<A HREF="../elks/readable_string_general.html#f_is_empty">is_empty</A>
            a_db_attached: <B>attached</B> a_db
            a_db_is_accessible: a_db.<A HREF="../sqlite/sqlite_database.html#f_is_accessible">is_accessible</A>
            a_db_is_readable: a_db.<A HREF="../sqlite/sqlite_database.html#f_is_readable">is_readable</A>
            a_statement_is_complete: a_db.<A HREF="../sqlite/sqlite_database.html#f_is_complete_statement">is_complete_statement</A> (a_statement)
        <B>do</B>
            <B>create</B> <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>.<A HREF="../elks/readable_string_8.html#f_make_from_string">make_from_string</A> (a_statement)
            <B>create</B> <A HREF="../sqlite/sqlite_statement.html#f_string">string</A>.<A HREF="../elks/readable_string_8.html#f_make_from_string">make_from_string</A> (a_statement)
            <A HREF="../sqlite/sqlite_statement.html#f_database">database</A> := a_db
            <B>if</B> {<A HREF="../elks/platform.html">PLATFORM</A>}.<A HREF="../elks/platform.html#f_is_thread_capable">is_thread_capable</A> <B>then</B>
                <A HREF="../sqlite/sqlite_statement.html#f_internal_thread_id">internal_thread_id</A> := <A HREF="../sqlite/sqlite_statement.html#f_get_current_thread_id">get_current_thread_id</A>.<A HREF="../elks/pointer.html#f_to_integer_32">to_integer_32</A>
            <B>end</B>
            <A HREF="../sqlite/sqlite_statement.html#f_compile">compile</A>
        <B>ensure</B>
            string_set: <A HREF="../sqlite/sqlite_statement.html#f_string">string</A>.<A HREF="../elks/readable_string_8.html#f_same_string">same_string</A> (a_statement)
            statement_string_attached: <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>
            not_statement_string_is_empty: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>.<A HREF="../elks/immutable_string_8.html#f_is_empty">is_empty</A>
            database_set: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A> = a_db
        <B>end</B></A>
    
<B>feature</B> {NONE} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Clean up</FONT>

    <A NAME="f_dispose"><A HREF="../sqlite/sqlite_statement.html#f_dispose">dispose</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Action to be executed just before garbage collection</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> reclaims an object.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Effect it in descendants to perform specific dispose</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> actions. Those actions should only take care of freeing</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> external resources; they should not perform remote calls</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> on other objects since these may also be dead and reclaimed.</FONT>
        <B>local</B>
            l_stmt: <B>like</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>
            l_db: <B>like</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A>
            l_api: <B>like</B> <A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>
            l_result: <A HREF="../elks/integer_32.html">INTEGER_32</A>
        <B>do</B>
            <B>if</B> <B>not</B> <A HREF="../elks/disposable.html#f_is_in_final_collect">is_in_final_collect</A> <B>then</B>
                l_stmt := <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>
                <B>if</B> l_stmt /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A> <B>and then</B> <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A> <B>then</B>
                    l_api := <A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>
                    l_db := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_db_handle">sqlite3_db_handle</A> (l_api, l_stmt)
                    <B>if</B> l_db /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A> <B>then</B>
                        <B>if</B> l_db = <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> <B>then</B>
                            l_result := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_finalize">sqlite3_finalize</A> (l_api, l_stmt)
                            <B>if</B> (l_result &#38; {<A HREF="../sqlite/sqlite_result_code.html">SQLITE_RESULT_CODE</A>}.<A HREF="../sqlite/sqlite_result_code.html#f_mask">mask</A>) = {<A HREF="../sqlite/sqlite_result_code.html">SQLITE_RESULT_CODE</A>}.<A HREF="../sqlite/sqlite_result_code.html#f_e_misuse">e_misuse</A> <B>then</B>
                                <B>check</B>
                                    is_closed: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_closed">is_closed</A>
                                <B>end</B>
                            <B>else</B>
                                <B>check</B>
                                    succeess: <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_success">sqlite_success</A> (l_result)
                                <B>end</B>
                            <B>end</B>
                        <B>else</B>
                            <B>check</B>
                                <B>False</B>
                            <B>end</B>
                        <B>end</B>
                    <B>end</B>
                <B>end</B>
                <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> := <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
                <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> := <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
            <B>end</B>
        <B>ensure then</B>
            not_is_compiled: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A>
            not_is_connected: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>
            internal_stmt_is_null: <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> = <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
            internal_db_is_null: <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> = <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
        <B>end</B></A>
    
<B>feature</B> <FONT COLOR="red">--</FONT><FONT COLOR="red"> Access</FONT>

    <A NAME="f_string"><A HREF="../sqlite/sqlite_statement.html#f_string">string</A>: <A HREF="../elks/immutable_string_8.html">IMMUTABLE_STRING_8</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> The full statement string passed during initialization.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> May contain multiple SQLite statements.</FONT>

    <A NAME="f_database"><A HREF="../sqlite/sqlite_statement.html#f_database">database</A>: <A HREF="../sqlite/sqlite_database.html">SQLITE_DATABASE</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Database to execute the SQL statement on.</FONT>

    <A NAME="f_statement_string"><A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>: <A HREF="../elks/immutable_string_8.html">IMMUTABLE_STRING_8</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> The actual compiled database string.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> This may not be the same as </FONT><A HREF="../sqlite/sqlite_statement.html#f_string">string</A><FONT COLOR="red"> because statements string can be composed of</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> of multiple statements. After compilation this will contain a single statement.</FONT>

    <A NAME="f_next_statement"><A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A>: <B>detachable</B> <A HREF="../sqlite/sqlite_statement.html">SQLITE_STATEMENT</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Next statement in the chain, when the supplied SQLite statement contained multiple SQLite</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> statements.</FONT>
    
<B>feature</B> <FONT COLOR="red">--</FONT><FONT COLOR="red"> Access: Error handling</FONT>

    <A NAME="f_last_exception"><A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A>: <B>detachable</B> <A HREF="../sqlite/sqlite_exception.html">SQLITE_EXCEPTION</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Last occurring error, set during compilation.</FONT>
    
<B>feature</B> <FONT COLOR="red">--</FONT><FONT COLOR="red"> Access: Cursor</FONT>

    <A NAME="f_execute_new"><A HREF="../sqlite/sqlite_statement.html#f_execute_new">execute_new</A>: <A HREF="../sqlite/sqlite_statement_iteration_cursor.html">SQLITE_STATEMENT_ITERATION_CURSOR</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Execute the SQLite statement.</FONT>
        <B>require</B>
            is_compiled: <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A>
            is_connected: <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>
            not_is_executing: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
            is_accessible: <A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A>
            not_has_arguments: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_has_arguments">has_arguments</A>
        <B>do</B>
            <B>create</B> <B>Result</B>.<A HREF="../sqlite/sqlite_statement_iteration_cursor.html#f_make">make</A> (<B>Current</B>)
        <B>ensure</B>
            result_attached: <B>attached</B> <B>Result</B>
        <B>end</B></A>

    <A NAME="f_execute_new_with_arguments"><A HREF="../sqlite/sqlite_statement.html#f_execute_new_with_arguments">execute_new_with_arguments</A> (a_arguments: <A HREF="../elks/iterable.html">ITERABLE</A> [<B>detachable</B> <A HREF="../elks/any.html">ANY</A>]): <A HREF="../sqlite/sqlite_statement_iteration_cursor.html">SQLITE_STATEMENT_ITERATION_CURSOR</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Executes the SQLite statement with bound set of arguments.</FONT>
            <FONT COLOR="red">--</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> </FONT>`a_arguments'<FONT COLOR="red">: The bound arguments to call the SQLite query statement with.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">                Valid arguments are those that descent </FONT><A HREF="../sqlite/sqlite_bind_arg.html">SQLITE_BIND_ARG</A><FONT COLOR="red"> or</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">                </FONT><A HREF="../elks/readable_string_8.html">READABLE_STRING_8</A><FONT COLOR="red">, or of type {INTEGER_*}, {NATURAL_*} (with the expection</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">                of </FONT><A HREF="../elks/natural_64.html">NATURAL_64</A><FONT COLOR="red">), or </FONT><A HREF="../elks/managed_pointer.html">MANAGED_POINTER</A><FONT COLOR="red"> (for blobs).</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">                Note: If *not* using </FONT><A HREF="../sqlite/sqlite_bind_arg.html">SQLITE_BIND_ARG</A><FONT COLOR="red">, the SQLite statement should use ?NNN</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">                      arguments and not named arguments.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">                      see </FONT><FONT COLOR="red">http://sqlite.org/c3ref/bind_blob.html</FONT>
        <B>require</B>
            is_compiled: <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A>
            is_connected: <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>
            not_is_executing: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
            is_accessible: <A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A>
            has_arguments: <A HREF="../sqlite/sqlite_statement.html#f_has_arguments">has_arguments</A>
            a_arguments_attached: <B>attached</B> a_arguments
            a_arguments_is_valid_arguments: <A HREF="../sqlite/sqlite_binding_helpers.html#f_is_valid_arguments">is_valid_arguments</A> (a_arguments)
        <B>do</B>
            <B>create</B> <B>Result</B>.<A HREF="../sqlite/sqlite_statement_iteration_cursor.html#f_make_with_bindings">make_with_bindings</A> (<B>Current</B>, <A HREF="../sqlite/sqlite_bind_arg_marshaller.html#f_new_binding_argument_array">new_binding_argument_array</A> (a_arguments))
        <B>ensure</B>
            result_attached: <B>attached</B> <B>Result</B>
        <B>end</B></A>
    
<B>feature</B> {NONE} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Access</FONT>

    <A NAME="f_compile_statement_string"><A HREF="../sqlite/sqlite_statement.html#f_compile_statement_string">compile_statement_string</A>: <A HREF="../elks/readable_string_8.html">READABLE_STRING_8</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> The statement used to compile with, which may be a modified version of </FONT>`statement'<FONT COLOR="red">.</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>
        <B>ensure</B>
            result_attached: <B>attached</B> <B>Result</B>
            not_result_is_empty: <B>not</B> <B>Result</B>.<A HREF="../elks/readable_string_general.html#f_is_empty">is_empty</A>
        <B>end</B></A>
    
<B>feature</B> <FONT COLOR="red">--</FONT><FONT COLOR="red"> Measurement</FONT>

    <A NAME="f_arguments_count"><A HREF="../sqlite/sqlite_statement.html#f_arguments_count">arguments_count</A>: <A HREF="../elks/natural_32.html">NATURAL_32</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Number of arguments required to be bound to execute the statement.</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_bind_parameter_count">sqlite3_bind_parameter_count</A> (<A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>, <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>).<A HREF="../elks/integer_32.html#f_as_natural_32">as_natural_32</A>
        <B>end</B></A>

    <A NAME="f_changes_count"><A HREF="../sqlite/sqlite_statement.html#f_changes_count">changes_count</A>: <A HREF="../elks/natural_32.html">NATURAL_32</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> The number of changes executing this statement caused</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_statement.html#f_internal_changes_count">internal_changes_count</A>
            <B>if</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A> <B>as</B> l_next <B>then</B>
                <B>Result</B> := <B>Result</B> + l_next.<A HREF="../sqlite/sqlite_statement.html#f_changes_count">changes_count</A>
            <B>end</B>
        <B>end</B></A>
    
<B>feature</B> {<A HREF="../sqlite/sqlite_result_row.html">SQLITE_RESULT_ROW</A>} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Measurement</FONT>

    <A NAME="f_mark"><A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A>: <A HREF="../elks/natural_32.html">NATURAL_32</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> The edition mark of the statement.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> A new mark is generated for each execution of recompilation.</FONT>
    
<B>feature</B> <FONT COLOR="red">--</FONT><FONT COLOR="red"> Status report</FONT>

    <A NAME="f_is_executing"><A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>: <A HREF="../elks/boolean.html">BOOLEAN</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Indicates if the statement is currently be executed.</FONT>

    <A NAME="f_is_compiled"><A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A>: <A HREF="../elks/boolean.html">BOOLEAN</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Indicates if the statement was successfully compiled, and if it is compiled with the</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> associated database </FONT><A HREF="../sqlite/sqlite_statement.html#f_database">database</A><FONT COLOR="red">.</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
        <B>ensure</B>
            not_internal_stmt_is_null: <B>Result</B> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
        <B>end</B></A>

    <A NAME="f_is_connected"><A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>: <A HREF="../elks/boolean.html">BOOLEAN</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Indicates if the statement is still connected to a database.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Disconnection occurs when a database connection is closed. Even when reopen the statement</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> will still remain disconnected. Use </FONT><A HREF="../sqlite/sqlite_statement.html#f_ensure_connected">ensure_connected</A><FONT COLOR="red"> to attempt to reconnect to the</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> associated database.</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A> <B>and then</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> = <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_internal_db">internal_db</A>
        <B>ensure</B>
            not_internal_stmt_is_null: <B>Result</B> <B>implies</B> (<A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A> <B>and then</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> = <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_internal_db">internal_db</A>)
        <B>end</B></A>

    <A NAME="f_is_accessible"><A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A>: <A HREF="../elks/boolean.html">BOOLEAN</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Indicates if the statement is accessible on the current thread.</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_shared_api.html#f_is_interface_usable">is_interface_usable</A> <B>and then</B> <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_accessible">is_accessible</A>
            <B>if</B> <B>Result</B> <B>then</B>
                <B>if</B> {<A HREF="../elks/platform.html">PLATFORM</A>}.<A HREF="../elks/platform.html#f_is_thread_capable">is_thread_capable</A> <B>then</B>
                    <B>Result</B> := <A HREF="../sqlite/sqlite_statement.html#f_internal_thread_id">internal_thread_id</A> = <A HREF="../sqlite/sqlite_statement.html#f_get_current_thread_id">get_current_thread_id</A>.<A HREF="../elks/pointer.html#f_to_integer_32">to_integer_32</A>
                <B>else</B>
                    <B>Result</B> := <B>True</B>
                <B>end</B>
            <B>end</B>
        <B>ensure</B>
            true_result: <B>not</B> {<A HREF="../elks/platform.html">PLATFORM</A>}.<A HREF="../elks/platform.html#f_is_thread_capable">is_thread_capable</A> <B>implies</B> (<B>Result</B> <B>and</B> <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_accessible">is_accessible</A>)
            same_internal_thread_id: (<B>Result</B> <B>and</B> {<A HREF="../elks/platform.html">PLATFORM</A>}.<A HREF="../elks/platform.html#f_is_thread_capable">is_thread_capable</A>) <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_thread_id">internal_thread_id</A> = <A HREF="../sqlite/sqlite_statement.html#f_get_current_thread_id">get_current_thread_id</A>.<A HREF="../elks/pointer.html#f_to_integer_32">to_integer_32</A>
        <B>end</B></A>

    <A NAME="f_has_arguments"><A HREF="../sqlite/sqlite_statement.html#f_has_arguments">has_arguments</A>: <A HREF="../elks/boolean.html">BOOLEAN</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Indicates if the statement has required arguments to execute.</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_statement.html#f_arguments_count">arguments_count</A> &gt; 0.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
        <B>ensure</B>
            has_arguments: <B>Result</B> = (<A HREF="../sqlite/sqlite_statement.html#f_arguments_count">arguments_count</A> &gt; 0.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>)
        <B>end</B></A>

    <A NAME="f_has_error"><A HREF="../sqlite/sqlite_statement.html#f_has_error">has_error</A>: <A HREF="../elks/boolean.html">BOOLEAN</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Indicates if an error occurred during the last operation.</FONT>
        <B>do</B>
            <B>Result</B> := <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> /= <B>Void</B>
        <B>ensure</B>
            last_exception_attached: <B>Result</B> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> /= <B>Void</B>
        <B>end</B></A>
    
<B>feature</B> {NONE} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Status report</FONT>

    <A NAME="f_is_abort_requested"><A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A>: <A HREF="../elks/boolean.html">BOOLEAN</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Indicates if an abort is requested for the currently executed statement.</FONT>
    
<B>feature</B> <FONT COLOR="red">--</FONT><FONT COLOR="red"> Basic operations</FONT>

    <A NAME="f_abort"><A HREF="../sqlite/sqlite_statement.html#f_abort">abort</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Aborts an executing statement.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Note: Unlike most of the routines, this can be called from another thread.</FONT>
        <B>require</B>
            is_sqlite_available: <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A>
            is_interface_usable: <A HREF="../sqlite/sqlite_shared_api.html#f_is_interface_usable">is_interface_usable</A>
            is_executing: <A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
        <B>do</B>
            <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A> := <B>True</B>
            <B>if</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A> <B>as</B> l_next <B>then</B>
                l_next.<A HREF="../sqlite/sqlite_statement.html#f_abort">abort</A>
            <B>end</B>
        <B>ensure</B>
            is_abort_requested: <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A>
        <B>end</B></A>

    <A NAME="f_ensure_connected"><A HREF="../sqlite/sqlite_statement.html#f_ensure_connected">ensure_connected</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Attempts to ensure a statement is connected to the associated database.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Note: This helper routine can be used prior to executing the statement to ensure the</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">       statement is compiled for use with the associated database. Statements become</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">       disconnected when the assoicated database is closed. Even when reopening the database</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">       a reconnection must be made.</FONT>
            <FONT COLOR="red">--</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">       Calling this routine will not reopen the database!</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">       Reconnection is not guarenteed!</FONT>
        <B>require</B>
            is_sqlite_available: <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A>
            is_interface_usable: <A HREF="../sqlite/sqlite_shared_api.html#f_is_interface_usable">is_interface_usable</A>
            is_accessible: <A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A>
            database_is_accessible: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_accessible">is_accessible</A>
            database_is_readable: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_readable">is_readable</A>
        <B>do</B>
            <B>if</B> <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A> <B>then</B>
                <A HREF="../sqlite/sqlite_statement.html#f_reset_compilation_data">reset_compilation_data</A>
                <A HREF="../sqlite/sqlite_statement.html#f_compile">compile</A>
            <B>end</B>
            <B>if</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A> <B>as</B> l_next <B>then</B>
                l_next.<A HREF="../sqlite/sqlite_statement.html#f_ensure_connected">ensure_connected</A>
            <B>end</B>
        <B>ensure</B>
            mark_increased: (<B>not</B> <B>old</B> <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>) <B>implies</B> (<A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A> &gt; <B>old</B> <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A>)
        <B>end</B></A>
    
<B>feature</B> {<A HREF="../sqlite/sqlite_statement.html">SQLITE_STATEMENT</A>} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Basic operations: Execution</FONT>

    <A NAME="f_reset"><A HREF="../sqlite/sqlite_statement.html#f_reset">reset</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Resets any cached information from the last execution.</FONT>
        <B>require</B>
            not_is_executing: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
        <B>do</B>
            <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A> := <B>False</B>
            <A HREF="../sqlite/sqlite_statement.html#f_internal_changes_count">internal_changes_count</A> := 0.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
            <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> := <B>Void</B>
        <B>ensure</B>
            not_is_abort_requested: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A>
            internal_changes_count_reset: <A HREF="../sqlite/sqlite_statement.html#f_internal_changes_count">internal_changes_count</A> = 0.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
            last_exception_detached: <B>not</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A>
            not_has_error: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_has_error">has_error</A>
        <B>end</B></A>

    <A NAME="f_reset_all"><A HREF="../sqlite/sqlite_statement.html#f_reset_all">reset_all</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Resets any cached information from the last execution for all statements.</FONT>
        <B>require</B>
            not_is_executing: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
        <B>do</B>
            <A HREF="../sqlite/sqlite_statement.html#f_reset">reset</A>
            <B>if</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A> <B>as</B> l_next <B>then</B>
                l_next.<A HREF="../sqlite/sqlite_statement.html#f_reset_all">reset_all</A>
            <B>end</B>
        <B>ensure</B>
            not_is_abort_requested: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A>
            internal_changes_count_reset: <A HREF="../sqlite/sqlite_statement.html#f_internal_changes_count">internal_changes_count</A> = 0.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
            last_exception_detached: <B>not</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A>
            not_has_error: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_has_error">has_error</A>
        <B>end</B></A>

    <A NAME="f_execute_internal"><A HREF="../sqlite/sqlite_statement.html#f_execute_internal">execute_internal</A> (a_callback: <B>detachable</B> <A HREF="../elks/function.html">FUNCTION</A> [<A HREF="../elks/any.html">ANY</A>, <A HREF="../elks/tuple.html">TUPLE</A> [row: <A HREF="../sqlite/sqlite_result_row.html">SQLITE_RESULT_ROW</A>], <A HREF="../elks/boolean.html">BOOLEAN</A>]; a_bindings: <B>detachable</B> <A HREF="../elks/array.html">ARRAY</A> [<A HREF="../sqlite/sqlite_bind_arg.html">SQLITE_BIND_ARG</A> [<A HREF="../elks/any.html">ANY</A>]])
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Performs execution of the SQLite statement with a callback routine for each returned result row.</FONT>
            <FONT COLOR="red">--</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> </FONT>`a_callback'<FONT COLOR="red">: A callback routine accepting a result row as its argument.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red">               Return True from the function to abort further calls when there is more result data.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> </FONT>`a_bindings'<FONT COLOR="red">: An array or binding arguments, or Void if the statement does not require any arguments.</FONT>
        <B>require</B>
            is_sqlite_available: <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A>
            is_interface_usable: <A HREF="../sqlite/sqlite_shared_api.html#f_is_interface_usable">is_interface_usable</A>
            is_compiled: <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A>
            is_connected: <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>
            not_is_executing: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
            is_accessible: <A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A>
            database_is_readable: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_readable">is_readable</A>
            a_bindings_attached: <A HREF="../sqlite/sqlite_statement.html#f_has_arguments">has_arguments</A> <B>implies</B> <B>attached</B> a_bindings
            a_bindings_count_big_enough: <B>not</B> <B>attached</B> a_bindings <B>or else</B> a_bindings.<A HREF="../elks/array.html#f_count">count</A>.<A HREF="../elks/integer_32.html#f_as_natural_32">as_natural_32</A> = <A HREF="../sqlite/sqlite_statement.html#f_arguments_count">arguments_count</A>
        <B>local</B>
            l_api: <B>like</B> <A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>
            l_stmt: <B>like</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>
            l_db: <B>detachable</B> <B>like</B> <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>
            l_exception: <B>detachable</B> <A HREF="../sqlite/sqlite_exception.html">SQLITE_EXCEPTION</A>
            l_result: <A HREF="../elks/integer_32.html">INTEGER_32</A>
            l_done: <A HREF="../elks/boolean.html">BOOLEAN</A>
            l_locked: <A HREF="../elks/boolean.html">BOOLEAN</A>
            l_row: <A HREF="../sqlite/sqlite_result_row.html">SQLITE_RESULT_ROW</A>
            i_upper, i: <A HREF="../elks/integer_32.html">INTEGER_32</A>
            l_arg_variable: <A HREF="../elks/immutable_string_8.html">IMMUTABLE_STRING_8</A>
            l_arg_id: <A HREF="../elks/c_string.html">C_STRING</A>
            l_arg_index: <A HREF="../elks/integer_32.html">INTEGER_32</A>
            l_total_count: <A HREF="../elks/natural_32.html">NATURAL_32</A>
        <B>do</B>
            <B>if</B> <B>attached</B> a_bindings <B>as</B> l_bindings <B>then</B>
                <B>from</B>
                    i := l_bindings.<A HREF="../elks/array.html#f_lower">lower</A>
                    i_upper := l_bindings.<A HREF="../elks/array.html#f_upper">upper</A>
                <B>until</B>
                    i &gt; i_upper
                <B>loop</B>
                    <B>if</B> <B>attached</B> l_bindings [i] <B>as</B> l_arg <B>then</B>
                        l_arg_variable := l_arg.<A HREF="../sqlite/sqlite_bind_arg.html#f_variable">variable</A>
                        <B>create</B> l_arg_id.<A HREF="../elks/c_string.html#f_make">make</A> (l_arg_variable)
                        l_arg_index := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_bind_parameter_index">sqlite3_bind_parameter_index</A> (<A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>, <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>, l_arg_id.<A HREF="../elks/c_string.html#f_item">item</A>)
                        <B>if</B> l_arg_index = 0 <B>and then</B> l_arg_variable [1] = '?' <B>then</B>
                            l_arg_variable := l_arg_variable.<A HREF="../elks/immutable_string_8.html#f_substring">substring</A> (2, l_arg_variable.<A HREF="../elks/readable_string_8.html#f_count">count</A>)
                            <B>if</B> l_arg_variable.<A HREF="../elks/readable_string_general.html#f_is_integer_32">is_integer_32</A> <B>then</B>
                                l_arg_index := l_arg_variable.<A HREF="../elks/readable_string_general.html#f_to_integer_32">to_integer_32</A>
                            <B>else</B>
                                <B>check</B>
                                    should_never_happen: <B>False</B>
                                <B>end</B>
                            <B>end</B>
                        <B>end</B>
                        <B>if</B> l_arg_index &gt; 0 <B>then</B>
                            l_arg.<A HREF="../sqlite/sqlite_bind_arg.html#f_bind_to_statement">bind_to_statement</A> (<B>Current</B>, l_arg_index)
                        <B>end</B>
                    <B>end</B>
                    i := i + 1
                <B>end</B>
            <B>end</B>
            <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A> := <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A> + 1.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
            l_api := <A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>
            l_stmt := <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>
            l_db := <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>
            <A HREF="../sqlite/sqlite_statement.html#f_reset_all">reset_all</A>
            <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A> := <B>True</B>
            <A HREF="../sqlite/sqlite_statement.html#f_on_before_execute">on_before_execute</A>
            l_db.<A HREF="../sqlite/sqlite_database.html#f_lock">lock</A>
            l_locked := <B>True</B>
            l_total_count := l_db.<A HREF="../sqlite/sqlite_database.html#f_total_changes_count">total_changes_count</A>
            <B>from</B>
                <B>create</B> l_row.<A HREF="../sqlite/sqlite_result_row.html#f_make">make</A> (<B>Current</B>)
                l_result := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_step">sqlite3_step</A> (l_api, l_stmt)
                l_done := l_result = {<A HREF="../sqlite/sqlite_result_code.html">SQLITE_RESULT_CODE</A>}.<A HREF="../sqlite/sqlite_result_code.html#f_done">done</A>
            <B>until</B>
                <B>not</B> <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_success">sqlite_success</A> (l_result) <B>or</B> l_done
            <B>loop</B>
                l_db.<A HREF="../sqlite/sqlite_database.html#f_unlock">unlock</A>
                l_locked := <B>False</B>
                <B>if</B> <B>attached</B> a_callback <B>then</B>
                    l_row.<A HREF="../sqlite/sqlite_result_row.html#f_index">index</A> := l_row.<A HREF="../sqlite/sqlite_result_row.html#f_index">index</A> + 1.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
                    <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A> := a_callback.<A HREF="../elks/function.html#f_item">item</A> ([l_row]) <B>or</B> <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A>
                <B>end</B>
                <B>if</B> <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A> <B>then</B>
                    l_db.<A HREF="../sqlite/sqlite_database.html#f_lock">lock</A>
                    l_locked := <B>True</B>
                    l_done := <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A>
                    <B>if</B> l_done <B>then</B>
                        l_db.<A HREF="../sqlite/sqlite_database.html#f_abort">abort</A>
                    <B>else</B>
                        l_done := l_result /= {<A HREF="../sqlite/sqlite_result_code.html">SQLITE_RESULT_CODE</A>}.<A HREF="../sqlite/sqlite_result_code.html#f_row">row</A>
                        <B>if</B> <B>not</B> l_done <B>then</B>
                            l_result := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_step">sqlite3_step</A> (l_api, l_stmt)
                            l_done := l_result = {<A HREF="../sqlite/sqlite_result_code.html">SQLITE_RESULT_CODE</A>}.<A HREF="../sqlite/sqlite_result_code.html#f_done">done</A>
                        <B>end</B>
                    <B>end</B>
                <B>else</B>
                    l_done := <B>True</B>
                <B>end</B>
            <B>end</B>
            <B>if</B> <B>not</B> <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_success">sqlite_success</A> (l_result) <B>then</B>
                <B>if</B> <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A> <B>then</B>
                    l_exception := l_db.<A HREF="../sqlite/sqlite_database.html#f_last_exception">last_exception</A>
                    <B>if</B> l_locked <B>then</B>
                        l_locked := <B>False</B>
                        l_db.<A HREF="../sqlite/sqlite_database.html#f_unlock">unlock</A>
                    <B>end</B>
                <B>end</B>
                <B>if</B> <B>not</B> <B>attached</B> l_exception <B>then</B>
                    l_exception := <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_exception">sqlite_exception</A> (l_result, <B>Void</B>)
                <B>end</B>
                <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> := l_exception
                <A HREF="../sqlite/sqlite_statement.html#f_on_after_executed">on_after_executed</A>
                l_exception.<A HREF="../elks/exception.html#f_raise">raise</A>
            <B>else</B>
                <A HREF="../sqlite/sqlite_statement.html#f_internal_changes_count">internal_changes_count</A> := l_db.<A HREF="../sqlite/sqlite_database.html#f_total_changes_count">total_changes_count</A> - l_total_count
                <B>if</B> l_locked <B>then</B>
                    l_locked := <B>False</B>
                    l_db.<A HREF="../sqlite/sqlite_database.html#f_unlock">unlock</A>
                <B>end</B>
                <B>if</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A> <B>as</B> l_next <B>then</B>
                    l_next.<A HREF="../sqlite/sqlite_statement.html#f_execute_internal">execute_internal</A> (a_callback, a_bindings)
                <B>end</B>
                <A HREF="../sqlite/sqlite_statement.html#f_on_after_executed">on_after_executed</A>
            <B>end</B>
            <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A> := <B>False</B>
            l_result := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_reset">sqlite3_reset</A> (l_api, l_stmt)
            <B>check</B>
                success: <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_success">sqlite_success</A> (l_result)
            <B>end</B>
            <B>if</B> <B>attached</B> a_bindings <B>then</B>
                l_result := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_clear_bindings">sqlite3_clear_bindings</A> (l_api, l_stmt)
                <B>check</B>
                    success: <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_success">sqlite_success</A> (l_result)
                <B>end</B>
            <B>end</B>
        <B>ensure</B>
            not_is_executing: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
            mark_increased: <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A> &gt; <B>old</B> <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A>
        <B>rescue</B>
            <B>if</B> l_locked <B>then</B>
                <B>check</B>
                    l_db_attached: <B>attached</B> l_db
                <B>end</B>
                l_locked := <B>False</B>
                l_db.<A HREF="../sqlite/sqlite_database.html#f_unlock">unlock</A>
            <B>end</B>
            <B>if</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A> <B>then</B>
                <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A> := <B>False</B>
                <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_reset">sqlite3_reset</A> (<A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>, <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>).<A HREF="../elks/any.html#f_do_nothing">do_nothing</A>
            <B>end</B>
        <B>end</B></A>
    
<B>feature</B> {NONE} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Basic operations: Compilation</FONT>

    <A NAME="f_reset_compilation_data"><A HREF="../sqlite/sqlite_statement.html#f_reset_compilation_data">reset_compilation_data</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Clears any cached information related to the preperation/compilation of the statement</FONT>
        <B>do</B>
            <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> := <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
            <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> := <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
            <A HREF="../sqlite/sqlite_statement.html#f_reset">reset</A>
            <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A> := <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A> + 1.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
        <B>ensure</B>
            not_is_compiled: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A>
            not_is_connected: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>
            not_is_abort_requested: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_abort_requested">is_abort_requested</A>
            internal_changes_count_reset: <A HREF="../sqlite/sqlite_statement.html#f_internal_changes_count">internal_changes_count</A> = 0.<A HREF="../elks/integer_32_ref.html#f_to_natural_32">to_natural_32</A>
            last_exception_detached: <B>not</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A>
            mark_increased: <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A> &gt; <B>old</B> <A HREF="../sqlite/sqlite_statement.html#f_mark">mark</A>
            not_has_error: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_has_error">has_error</A>
        <B>end</B></A>

    <A NAME="f_compile"><A HREF="../sqlite/sqlite_statement.html#f_compile">compile</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Compiles the current statement.</FONT>
        <B>require</B>
            is_sqlite_available: <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A>
            is_interface_usable: <A HREF="../sqlite/sqlite_shared_api.html#f_is_interface_usable">is_interface_usable</A>
            not_is_connected: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>
            not_has_error: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_has_error">has_error</A>
            database_is_readable: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_readable">is_readable</A>
            database: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_readable">is_readable</A>
        <B>local</B>
            l_db: <B>like</B> <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>
            l_string: <A HREF="../elks/c_string.html">C_STRING</A>
            l_next_string: <A HREF="../elks/string_8.html">STRING_8</A>
            l_next_statement: <A HREF="../sqlite/sqlite_statement.html">SQLITE_STATEMENT</A>
            l_stmt_handle: <A HREF="../elks/pointer.html">POINTER</A>
            l_internal_db: <A HREF="../elks/pointer.html">POINTER</A>
            l_tail: <A HREF="../elks/pointer.html">POINTER</A>
            l_locked: <A HREF="../elks/boolean.html">BOOLEAN</A>
            l_result: <A HREF="../elks/integer_32.html">INTEGER_32</A>
        <B>do</B>
            <B>create</B> l_string.<A HREF="../elks/c_string.html#f_make">make</A> (<A HREF="../sqlite/sqlite_statement.html#f_compile_statement_string">compile_statement_string</A>)
            l_db := <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>
            l_db.<A HREF="../sqlite/sqlite_database.html#f_lock">lock</A>
            l_locked := <B>True</B>
            l_internal_db := l_db.<A HREF="../sqlite/sqlite_database.html#f_internal_db">internal_db</A>
            l_result := <A HREF="../sqlite/sqlite_statement_externals.html#f_sqlite3_prepare_v2">sqlite3_prepare_v2</A> (<A HREF="../sqlite/sqlite_shared_api.html#f_sqlite_api">Sqlite_api</A>, l_internal_db, l_string.<A HREF="../elks/c_string.html#f_item">item</A>, l_string.<A HREF="../elks/c_string.html#f_count">count</A> + 1, $l_stmt_handle, $l_tail)
            <B>if</B> l_stmt_handle /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A> <B>then</B>
                <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> := l_stmt_handle
                <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> := l_internal_db
                <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> := <B>Void</B>
                <B>if</B> l_tail /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A> <B>then</B>
                    <B>check</B>
                        next_statement_detached: <B>not</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A>
                    <B>end</B>
                    <B>create</B> l_string.<A HREF="../elks/c_string.html#f_make_shared_from_pointer">make_shared_from_pointer</A> (l_tail)
                    l_next_string := l_string.<A HREF="../elks/c_string.html#f_string">string</A>
                    <B>if</B> <B>not</B> l_next_string.<A HREF="../elks/finite.html#f_is_empty">is_empty</A> <B>then</B>
                        <B>create</B> <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>.<A HREF="../elks/readable_string_8.html#f_make_from_string">make_from_string</A> (<A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>.<A HREF="../elks/immutable_string_8.html#f_substring">substring</A> (1, <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>.<A HREF="../elks/readable_string_8.html#f_count">count</A> - l_next_string.<A HREF="../elks/readable_string_8.html#f_count">count</A>))
                        l_next_string.<A HREF="../elks/string_8.html#f_prune_all_leading">prune_all_leading</A> (';')
                        l_next_string.<A HREF="../elks/string_8.html#f_left_adjust">left_adjust</A>
                        <B>if</B> <B>not</B> l_next_string.<A HREF="../elks/finite.html#f_is_empty">is_empty</A> <B>then</B>
                            <B>create</B> l_next_statement.<A HREF="../sqlite/sqlite_statement.html#f_make">make</A> (l_next_string, l_db)
                            <B>if</B> l_next_statement.<A HREF="../sqlite/sqlite_statement.html#f_has_error">has_error</A> <B>then</B>
                                <A HREF="../sqlite/sqlite_statement.html#f_reset_compilation_data">reset_compilation_data</A>
                                <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> := l_next_statement.<A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A>
                            <B>else</B>
                                <A HREF="../sqlite/sqlite_statement.html#f_next_statement">next_statement</A> := l_next_statement
                            <B>end</B>
                        <B>end</B>
                    <B>end</B>
                <B>end</B>
            <B>else</B>
                <A HREF="../sqlite/sqlite_statement.html#f_reset_compilation_data">reset_compilation_data</A>
                <B>if</B> <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_success">sqlite_success</A> (l_result) <B>then</B>
                    <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> := <A HREF="../sqlite/sqlite_helpers.html#f_sqlite_exception">sqlite_exception</A> ({<A HREF="../sqlite/sqlite_result_code.html">SQLITE_RESULT_CODE</A>}.<A HREF="../sqlite/sqlite_result_code.html#f_e_misuse">e_misuse</A>, "no statement: syntax error")
                <B>else</B>
                    <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A> := l_db.<A HREF="../sqlite/sqlite_database.html#f_last_exception">last_exception</A>
                <B>end</B>
            <B>end</B>
            l_locked := <B>False</B>
            l_db.<A HREF="../sqlite/sqlite_database.html#f_unlock">unlock</A>
        <B>ensure</B>
            not_internal_db_is_null: <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
            internal_db_is_null: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> = <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
            last_exception_attached: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A> <B>implies</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A>
            last_exception_attached: <A HREF="../sqlite/sqlite_statement.html#f_is_compiled">is_compiled</A> <B>implies</B> <B>not</B> <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_last_exception">last_exception</A>
        <B>rescue</B>
            <B>if</B> l_locked <B>then</B>
                l_locked := <B>False</B>
                <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_unlock">unlock</A>
            <B>end</B>
        <B>end</B></A>
    
<B>feature</B> {<A HREF="../sqlite/sqlite_statement_iteration_cursor.html">SQLITE_STATEMENT_ITERATION_CURSOR</A>} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Action handlers</FONT>

    <A NAME="f_on_before_execute"><A HREF="../sqlite/sqlite_statement.html#f_on_before_execute">on_before_execute</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Called before a statement has been executed.</FONT>
        <B>require</B>
            is_sqlite_available: <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A>
            is_interface_usable: <A HREF="../sqlite/sqlite_shared_api.html#f_is_interface_usable">is_interface_usable</A>
            is_connected: <A HREF="../sqlite/sqlite_statement.html#f_is_connected">is_connected</A>
            not_has_error: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_has_error">has_error</A>
            is_accessible: <A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A>
            database_is_readable: <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>.<A HREF="../sqlite/sqlite_database.html#f_is_readable">is_readable</A>
        <B>do</B>
            <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A> := <B>True</B>
        <B>ensure</B>
            is_executing: <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
        <B>end</B></A>

    <A NAME="f_on_after_executed"><A HREF="../sqlite/sqlite_statement.html#f_on_after_executed">on_after_executed</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Called after a statement has been executed, successfully or not.</FONT>
        <B>require</B>
            is_sqlite_available: <A HREF="../sqlite/sqlite_shared_api.html#f_is_sqlite_available">Is_sqlite_available</A>
            is_interface_usable: <A HREF="../sqlite/sqlite_shared_api.html#f_is_interface_usable">is_interface_usable</A>
            is_accessible: <A HREF="../sqlite/sqlite_statement.html#f_is_accessible">is_accessible</A>
        <B>do</B>
            <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A> := <B>False</B>
        <B>ensure</B>
            not_is_executing: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_is_executing">is_executing</A>
        <B>end</B></A>
    
<B>feature</B> {<A HREF="../sqlite/sqlite_internals.html">SQLITE_INTERNALS</A>} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Implementation</FONT>

    <A NAME="f_internal_stmt"><A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A>: <A HREF="../elks/pointer.html">POINTER</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Pointer to the compiled statement</FONT>

    <A NAME="f_internal_db"><A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A>: <A HREF="../elks/pointer.html">POINTER</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> The pointer to the database connection when the statement was compiled.</FONT>

    <A NAME="f_internal_changes_count"><A HREF="../sqlite/sqlite_statement.html#f_internal_changes_count">internal_changes_count</A>: <A HREF="../elks/natural_32.html">NATURAL_32</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Mutable version of </FONT><A HREF="../sqlite/sqlite_statement.html#f_changes_count">changes_count</A><FONT COLOR="red">.</FONT>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Note: Do not use directly!</FONT>
    
<B>feature</B> {NONE} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Implementation</FONT>

    <A NAME="f_internal_thread_id"><A HREF="../sqlite/sqlite_statement.html#f_internal_thread_id">internal_thread_id</A>: <A HREF="../elks/integer_32.html">INTEGER_32</A></A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> The thread the database was connected using.</FONT>
    
<B>feature</B> {NONE} <FONT COLOR="red">--</FONT><FONT COLOR="red"> Externals</FONT>

    <A NAME="f_get_current_thread_id"><A HREF="../sqlite/sqlite_statement.html#f_get_current_thread_id">get_current_thread_id</A>: <A HREF="../elks/pointer.html">POINTER</A>
            <FONT COLOR="red">--</FONT><FONT COLOR="red"> Returns a pointer to the thread-id of the thread.</FONT>
        <B>require</B>
            is_thread_capable: {<A HREF="../elks/platform.html">PLATFORM</A>}.<A HREF="../elks/platform.html#f_is_thread_capable">is_thread_capable</A>
        <B>external</B>
            "C use %"eif_threads.h%""
        <B>alias</B>
            "eif_thr_thread_id"
        <B>end</B></A>
    
<B>invariant</B>
    database_attached: <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_database">database</A>
    statement_attached: <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>
    not_statement_is_empty: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_statement_string">statement_string</A>.<A HREF="../elks/immutable_string_8.html#f_is_empty">is_empty</A>
    string_attached: <B>attached</B> <A HREF="../sqlite/sqlite_statement.html#f_string">string</A>
    not_string_is_empty: <B>not</B> <A HREF="../sqlite/sqlite_statement.html#f_string">string</A>.<A HREF="../elks/immutable_string_8.html#f_is_empty">is_empty</A>
    not_internal_db_is_null: <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> /= <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
    internal_db_is_null: <A HREF="../sqlite/sqlite_statement.html#f_internal_stmt">internal_stmt</A> = <A HREF="../elks/any.html#f_default_pointer">default_pointer</A> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_db">internal_db</A> = <A HREF="../elks/any.html#f_default_pointer">default_pointer</A>
    internal_thread_id_set: {<A HREF="../elks/platform.html">PLATFORM</A>}.<A HREF="../elks/platform.html#f_is_thread_capable">is_thread_capable</A> <B>implies</B> <A HREF="../sqlite/sqlite_statement.html#f_internal_thread_id">internal_thread_id</A> /= 0

<B>note</B>
    copyright: "Copyright (c) 1984-2013, Eiffel Software"
    license: "GPL version 2 (see <a href="http://www.eiffel.com/licensing/gpl.txt">http://www.eiffel.com/licensing/gpl.txt</a>)"
    licensing_options: "<a href="http://www.eiffel.com/licensing">http://www.eiffel.com/licensing</a>"
    copying: "[
        This file is part of Eiffel Software's Eiffel Development Environment.
        
        Eiffel Software's Eiffel Development Environment is free
        software; you can redistribute it and/or modify it under
        the terms of the GNU General Public License as published
        by the Free Software Foundation, version 2 of the License
        (available at the URL listed under "license" above).
        
        Eiffel Software's Eiffel Development Environment is
        distributed in the hope that it will be useful, but
        WITHOUT ANY WARRANTY; without even the implied warranty
        of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
        See the GNU General Public License for more details.
        
        You should have received a copy of the GNU General Public
        License along with Eiffel Software's Eiffel Development
        Environment; if not, write to the Free Software Foundation,
        Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
    ]"
    source: "[
        Eiffel Software
        5949 Hollister Ave., Goleta, CA 93117 USA
        Telephone 805-685-1006, Fax 805-685-6869
        Website <a href="http://www.eiffel.com">http://www.eiffel.com</a>
        Customer support <a href="http://support.eiffel.com">http://support.eiffel.com</a>
    ]"

<B>end</B> <FONT COLOR="red">--</FONT> <FONT COLOR="red">class </FONT><A HREF="../sqlite/sqlite_statement.html">SQLITE_STATEMENT</A><TABLE BORDER="1" ALIGN="CENTER"><TR><TD><A HREF="../class_list.html">Classes</A></TD><TD><A HREF="../cluster_list.html">Clusters</A></TD><TD><A HREF="../cluster_hierarchy.html">Cluster hierarchy</A></TD><TD><A HREF="sqlite_statement_chart.html">Chart</A></TD><TD><A HREF="sqlite_statement_links.html">Relations</A></TD><TD>Text</TD><TD><A HREF="sqlite_statement_flat.html">Flat</A></TD><TD><A HREF="sqlite_statement_short.html">Contracts</A></TD><TD><A HREF="sqlite_statement_flatshort.html">Flat contracts</A></TD></TR></TABLE></PRE>
<P ALIGN="CENTER"> &#045;&#045; Generated by ISE Eiffel &#045;&#045 </P>
<P ALIGN="CENTER">For more details: <A HREF="http://www.eiffel.com">www.eiffel.com</A></P>
</BODY>
</HTML>

